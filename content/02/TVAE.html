
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.4. Tabular Variational Autoencoder (TVAE) &#8212; FLATCLASS - FLATfish Length and Thickness CLASification System by Artificial Intelligence</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/02/TVAE';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="4.5. Conclusión" href="Conclusion.html" />
    <link rel="prev" title="4.3. Conditional Tabular GAN (CTGAN)" href="CTGAN.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/flatclass_logo.png" class="logo__image only-light" alt="FLATCLASS - FLATfish Length and Thickness CLASification System by Artificial Intelligence - Home"/>
    <script>document.write(`<img src="../../_static/flatclass_logo.png" class="logo__image only-dark" alt="FLATCLASS - FLATfish Length and Thickness CLASification System by Artificial Intelligence - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">PT1 - Visión Artificial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01/Requisitos.html">1. Especificación de requisitos</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../01/Imagen.html">2. Sistema de visión artificial</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../01/Modulo-1.html">2.2. M1 - Captura</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/Modulo-2.html">2.3. M2 - Calibración</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/Modulo-3.html">2.4. M3 - Imagen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../01/Modulo-4.html">2.5. M4 - Salida y persistencia</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PT2 - Datasets</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Dataset.html">3. Obtención y etiquetado del dataset</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="Generador.html">4. Generación de datos sintéticos</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="GaussianCopula.html">4.2. Gaussian Copula</a></li>
<li class="toctree-l2"><a class="reference internal" href="CTGAN.html">4.3. Conditional Tabular GAN (CTGAN)</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">4.4. Tabular Variational Autoencoder (TVAE)</a></li>
<li class="toctree-l2"><a class="reference internal" href="Conclusion.html">4.5. Conclusión</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PT3 - Predicción del Peso</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../03/Peso.html">5. Desarrollo Experimental de un Modelo de IA para la Estimación del Peso</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../03/Coeficientes.html">5.2. Estudio matemático de las relaciones entre las dimensiones morfológicas y el peso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/Analisis.html">5.3. Análisis del modelo alométrico longitud-anchura</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03/Modelo.html">5.4. Algoritmo de inferencia del peso <span class="math notranslate nohighlight">\(W\)</span></a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">PT4 - Sistema de clasificación automática</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../04/Mecatronica.html">6. Sistema mecatrónico de separación</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">



<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>

</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Tabular Variational Autoencoder (TVAE)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="tabular-variational-autoencoder-tvae">
<h1><span class="section-number">4.4. </span>Tabular Variational Autoencoder (TVAE)<a class="headerlink" href="#tabular-variational-autoencoder-tvae" title="Link to this heading">#</a></h1>
<p>El TVAE (Tabular Variational Autoencoder) es otro método avanzado de inteligencia artificial para generar datos sintéticos realísticos que combina redes neuronales con principios estadísticos. En esencia, funciona como un sistema de compresión y reconstrucción inteligente: primero, un “<em>encoder</em>” reduce los datos originales a una representación compacta llamada “espacio latente”, donde se capturan las características esenciales de la información. Luego, un “<em>decoder</em>” utiliza esta representación para recrear los datos originales o generar nuevas muestras sintéticas. Lo que diferencia al TVAE de métodos más simples es que este espacio latente no es caótico, sino que sigue una distribución gaussiana controlada, lo que permite generar datos variados pero coherentes con la estructura original.</p>
<p>Matemáticamente, el TVAE se basa en el concepto de “inferencia variacional”, que busca aproximar distribuciones complejas de datos mediante modelos probabilísticos. Durante el entrenamiento, el sistema no solo aprende a reconstruir datos, sino que también minimiza la divergencia entre la distribución del espacio latente y una distribución gaussiana estándar. Esto se logra mediante una función de pérdida que balancea dos objetivos: la precisión en la reconstrucción (para que los datos sintéticos se parezcan a los reales) y la regularización (para que el espacio latente mantenga una estructura estadística ordenada). Este equilibrio evita que el modelo genere datos idénticos a los originales o, por el contrario, produzca información sin sentido.</p>
<p>Para adaptarse específicamente a datos tabulares (como es en nuestro caso), el TVAE incorpora transformaciones especializadas. Así, las variables continuas se modelan como mezclas de distribuciones gaussianas, lo que permite capturar multimodalidad (varios picos en los datos), mientras que las variables categóricas se procesan con codificaciones que preservan sus relaciones. Esta flexibilidad permite al TVAE manejar relaciones no lineales y complejas entre variables, como las típicas en datos biológicos, donde métodos tradicionales basados en correlaciones lineales resultan insuficientes.</p>
<p>La principal ventaja del TVAE frente a métodos como Gaussian Copula radica en su capacidad para aprender patrones intrincados sin depender de suposiciones simplificadas sobre la estructura de los datos. Sin embargo, requiere mayor poder computacional y ajuste fino de hiperparámetros (como la dimensión del espacio latente o el peso de la regularización). Por esto, es ideal para casos donde la calidad de los datos sintéticos es crítica, como en investigación médica o biológica <a class="reference external" href="https://doi.org/10.48550/arXiv.2205.03257">[Jordon et al., 2022]</a>, donde preservar la complejidad de las distribuciones originales es esencial para validaciones posteriores. Su fundamento matemático lo convierte en una herramienta robusta para expandir conjuntos de datos limitados manteniendo la consistencia estadística de la población original.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sdv.single_table</span><span class="w"> </span><span class="kn">import</span> <span class="n">TVAESynthesizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sdv.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">SingleTableMetadata</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sdv.evaluation.single_table</span><span class="w"> </span><span class="kn">import</span> <span class="n">run_diagnostic</span><span class="p">,</span> <span class="n">evaluate_quality</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sdv.evaluation.single_table</span><span class="w"> </span><span class="kn">import</span> <span class="n">get_column_plot</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">sdv.metadata</span><span class="w"> </span><span class="kn">import</span> <span class="n">Metadata</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">myst_nb</span><span class="w"> </span><span class="kn">import</span> <span class="n">glue</span>

<span class="n">num_synthetic</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1">#variable para definir el número de registros sintéticos</span>

<span class="c1"># 1. Cargar datos reales</span>
<span class="c1">#--------------------------</span>
<span class="n">path_realData</span> <span class="o">=</span> <span class="s1">&#39;.././data/Dimensiones_lenguado.xlsx&#39;</span>  
<span class="n">real_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="n">path_realData</span><span class="p">)</span>

<span class="c1"># 2. Obtener los metadata del dataset</span>
<span class="c1">#--------------------------------------</span>

<span class="n">metadata_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s1">&#39;.././data/metadata_lenguado.json&#39;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">metadata_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
    <span class="c1"># Cargar metadatos desde el JSON (evita el warning)</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">Metadata</span><span class="o">.</span><span class="n">load_from_json</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Metadatos cargados desde JSON.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># Detectar metadatos y guardarlos en JSON para futuras ejecuciones</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">Metadata</span><span class="o">.</span><span class="n">detect_from_dataframe</span><span class="p">(</span><span class="n">real_data</span><span class="p">)</span>
    <span class="n">metadata</span><span class="o">.</span><span class="n">save_to_json</span><span class="p">(</span><span class="n">metadata_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Metadatos detectados y guardados en JSON.&quot;</span><span class="p">)</span>

<span class="c1"># 3. Inicializar y entrenar TVAE</span>
<span class="c1">#--------------------------------</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Inicializando TVAE...&quot;</span><span class="p">)</span>
<span class="n">tvae_model</span> <span class="o">=</span> <span class="n">TVAESynthesizer</span><span class="p">(</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="n">metadata</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>           <span class="c1"># Número de épocas de entrenamiento</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span>        <span class="c1"># Tamaño del batch</span>
    <span class="n">embedding_dim</span><span class="o">=</span><span class="mi">128</span><span class="p">,</span>    <span class="c1"># Dimensión del espacio latente</span>
    <span class="n">compress_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span>  <span class="c1"># Capas del encoder</span>
    <span class="n">decompress_dims</span><span class="o">=</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">),</span> <span class="c1"># Capas del decoder</span>
    <span class="n">loss_factor</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>        <span class="c1"># Balance entre pérdida de reconstrucción y KL</span>
    <span class="n">cuda</span><span class="o">=</span><span class="kc">True</span>             <span class="c1"># Usar GPU si está disponible</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Entrenando TVAE (esto puede tomar varios minutos)...&quot;</span><span class="p">)</span>
<span class="n">tvae_model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">real_data</span><span class="p">)</span>

<span class="c1"># 4. Generar datos sintéticos</span>
<span class="c1">#-----------------------------</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Generando datos sintéticos...&quot;</span><span class="p">)</span>
<span class="n">syntheticTVAE_data</span> <span class="o">=</span> <span class="n">tvae_model</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">num_rows</span><span class="o">=</span><span class="mi">500</span><span class="p">);</span>
<span class="n">display</span><span class="p">(</span><span class="n">syntheticTVAE_data</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Se muestran 10 primeros registros sintéticos TVAE de un total de </span><span class="si">{</span><span class="n">num_synthetic</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># 5. Guardar resultados</span>
<span class="c1">#-------------------------</span>
<span class="n">path_syntheticTVAEData</span> <span class="o">=</span> <span class="s2">&quot;.././data/SyntheticTVAE.xlsx&quot;</span>
<span class="n">syntheticTVAE_data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="n">path_syntheticTVAEData</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;openpyxl&#39;</span><span class="p">)</span>

<span class="c1"># 6. Evaluación datos sintéticos</span>
<span class="c1">#-------------------------------</span>

<span class="c1">## Diagnóstico básico</span>
<span class="n">diagnosticTVAE</span> <span class="o">=</span> <span class="n">run_diagnostic</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">syntheticTVAE_data</span><span class="p">,</span> <span class="n">metadata</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">DIAGNÓSTICO BÁSICO CALIDAD DATOS</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diagnosticTVAE</span><span class="o">.</span><span class="n">get_details</span><span class="p">(</span><span class="n">property_name</span><span class="o">=</span><span class="s1">&#39;Data Validity&#39;</span><span class="p">))</span>

<span class="c1">## Visualización datos</span>
<span class="c1">#--------------------------------</span>

<span class="n">columnas</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Peso (g)&quot;</span><span class="p">,</span> <span class="s2">&quot;Longitud (cm)&quot;</span><span class="p">,</span> <span class="s2">&quot;Anchura (cm)&quot;</span><span class="p">,</span> <span class="s2">&quot;Altura (cm)&quot;</span><span class="p">]</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">variables</span> <span class="o">=</span> <span class="n">real_data</span><span class="o">.</span><span class="n">columns</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">variables</span><span class="p">):</span>
    <span class="n">row</span><span class="p">,</span> <span class="n">col</span> <span class="o">=</span> <span class="n">i</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">real_data</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Real&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">kdeplot</span><span class="p">(</span><span class="n">syntheticTVAE_data</span><span class="p">[</span><span class="n">var</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sintético&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribución de </span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Comparación: Datos Reales vs Sintéticos (TVAE)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.98</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="c1">## Medidas de similiud estadística</span>

<span class="n">quality_reportTVAE</span> <span class="o">=</span> <span class="n">evaluate_quality</span><span class="p">(</span><span class="n">real_data</span><span class="p">,</span> <span class="n">syntheticTVAE_data</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">real_data</span><span class="p">),</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">),</span> <span class="n">metadata</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>

<span class="c1">## Obtenemos el valor promedio de la similitud</span>
<span class="n">overall_scoreTVAE</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">quality_reportTVAE</span><span class="o">.</span><span class="n">get_score</span><span class="p">()</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%&quot;</span>
<span class="n">glue</span><span class="p">(</span><span class="s2">&quot;scoreTVAE&quot;</span><span class="p">,</span> <span class="n">overall_scoreTVAE</span><span class="p">,</span> <span class="n">display</span><span class="o">=</span><span class="kc">False</span><span class="p">);</span> <span class="c1"># Definimos una variable para usar en el texto markdown</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">SIMILITUD ESTADÍSTICA</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Overall score: </span><span class="si">{</span><span class="n">overall_scoreTVAE</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Distribuciones individuales real vs. sintética</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quality_reportTVAE</span><span class="o">.</span><span class="n">get_details</span><span class="p">(</span><span class="s1">&#39;Column Shapes&#39;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> Correlaciones entre variables real vs. sintética</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">quality_reportTVAE</span><span class="o">.</span><span class="n">get_details</span><span class="p">(</span><span class="s1">&#39;Column Pair Trends&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Metadatos cargados desde JSON.
Inicializando TVAE...
Entrenando TVAE (esto puede tomar varios minutos)...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Generando datos sintéticos...
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Peso (g)</th>
      <th>Longitud (cm)</th>
      <th>Anchura (cm)</th>
      <th>Altura (cm)</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.35</td>
      <td>6.8</td>
      <td>2.6</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>1</th>
      <td>6.25</td>
      <td>6.2</td>
      <td>2.2</td>
      <td>0.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.36</td>
      <td>5.4</td>
      <td>2.2</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2.69</td>
      <td>6.2</td>
      <td>2.3</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.81</td>
      <td>10.4</td>
      <td>3.6</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>5</th>
      <td>3.55</td>
      <td>6.8</td>
      <td>2.3</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>15.08</td>
      <td>9.9</td>
      <td>4.6</td>
      <td>0.7</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8.24</td>
      <td>9.9</td>
      <td>3.4</td>
      <td>0.6</td>
    </tr>
    <tr>
      <th>8</th>
      <td>3.59</td>
      <td>6.4</td>
      <td>2.1</td>
      <td>0.4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>13.30</td>
      <td>10.3</td>
      <td>3.4</td>
      <td>0.6</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Se muestran 10 primeros registros sintéticos TVAE de un total de 500

DIAGNÓSTICO BÁSICO CALIDAD DATOS

          Column             Metric  Score
0       Peso (g)  BoundaryAdherence    1.0
1  Longitud (cm)  BoundaryAdherence    1.0
2   Anchura (cm)  BoundaryAdherence    1.0
3    Altura (cm)  BoundaryAdherence    1.0
</pre></div>
</div>
<img alt="../../_images/d5f76efac563cb593258ab80beb7a52988639d3eb3577143baef30497d3d9561.png" src="../../_images/d5f76efac563cb593258ab80beb7a52988639d3eb3577143baef30497d3d9561.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SIMILITUD ESTADÍSTICA

Overall score: 92.54%


 Distribuciones individuales real vs. sintética

          Column        Metric     Score
0       Peso (g)  KSComplement  0.913876
1  Longitud (cm)  KSComplement  0.918660
2   Anchura (cm)  KSComplement  0.913876
3    Altura (cm)  KSComplement  0.952153

 Correlaciones entre variables real vs. sintética

        Column 1       Column 2                 Metric     Score  \
0       Peso (g)  Longitud (cm)  CorrelationSimilarity  0.925652   
1       Peso (g)   Anchura (cm)  CorrelationSimilarity  0.880504   
2       Peso (g)    Altura (cm)  CorrelationSimilarity  0.955566   
3  Longitud (cm)   Anchura (cm)  CorrelationSimilarity  0.894175   
4  Longitud (cm)    Altura (cm)  CorrelationSimilarity  0.952077   
5   Anchura (cm)    Altura (cm)  CorrelationSimilarity  0.949156   

   Real Correlation  Synthetic Correlation  
0          0.932951               0.784255  
1          0.942354               0.703363  
2          0.861768               0.772900  
3          0.936674               0.725024  
4          0.870165               0.774319  
5          0.842673               0.740985  
</pre></div>
</div>
</div>
</div>
<p>En líneas generales, este método proporciona una similud estadística general del <span class="output text_plain">‘92.54%’</span>. Un análisis con mayor detalle nos revela que la generación de datos sintéticos a nivel de variable individual mantiene razonablemente bien las características originales (<span class="math notranslate nohighlight">\(\approx 90\%\)</span>). Por otro lado, la métrica <code class="docutils literal notranslate"><span class="pre">CorrelationSimilarity</span></code> entre pares de variables es elevada aunque inferior al método Gaussian Copula. En lo que se refiere a las correlaciones sintéticas entre variables, los valores porcentuales son bastante menores que los correspondientes referencias con datos reales, lo cual sugiere que los datos obtenidos pueden no ser válidos para entrenamiento de algoritmos de <em>machine learning</em>.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/02"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="CTGAN.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4.3. </span>Conditional Tabular GAN (CTGAN)</p>
      </div>
    </a>
    <a class="right-next"
       href="Conclusion.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4.5. </span>Conclusión</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Javier Álvarez Osuna
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Feeding Systems S.L. - GNU General Public License 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>